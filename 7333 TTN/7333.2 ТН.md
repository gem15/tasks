ПЗ 7382
Продолжение ПЗ 7333 (новая ТТН).
Учёт перевозчиков.
Суть постановки: Форма стандартной заявки EXCEL дополняется рядом полей (смотри вложение).
Код перевозчика анализируется аналогично анализу когда получателя/поставщика.
При получении нового когда пееревозчика, не зарегистрированного в таблице клиентов (KB_ZAK) он в ней фиксируется привязывается в качестве ссылки в создаваемом транспортном средстве.
Если код перевозчика уже существует в таблице KB_ZAK, то сслыка на ID перевозчика просто привязывается в создаваемом ТС.

ручная ветка

"Добавляем строку 20 с полем Код перевозчика. Это уникальный код перевозчика в учётных системах заказчика (аналогичный коду грузополучателя, указываемому в строке 8).
"
Код перевозчика может содержать до 38 буквенно-цыфровых символов. 
Если код встречается в заявках клиента первый раз, то он должен быть дополнен двумя непустыми полями, иначе его регистрация в справочнике клиентов АРМ не производится: 
    - Строка 21 - ИНН перевозчика (обязательно только в ПЕРВОЙ заявке с данным перевозчиком); 
    - Строка 22 - Наименование перевозчика  (обязательно только в ПЕРВОЙ заявке с данным перевозчиком).
Ссылка на перевозчика фиксируется в поле "Перевозчик" блока "Сведения экспедитора" ТС, которое создаётся в процессе обработки заявки и передачи информации в СУС 
Если "Код перевозчика" указан, то предполагается наличие также номера ТС в строке 18 заявки. 
Требование обусловлено тем, что если создавать транспортные средства без номера, то может происходить неоднозначная идентификация ТС по номеру машины и плановому времени. 
Поэтому без непустого значения (причём отличного от Б/Н) номера машины в заявке поля, соответствующие ПЕРЕВОЗЧИКУ обрабатываться не будут.

Первичная регистрация ПЕРЕВОЗЧИКА в списке клиентов АРМ производится аналогично регистрации (выбору из ранее зарегистрированных значений) данных о грузополучателе.
Единственная разница - это тип регистрируемого (выбираемого) контрагента в таблице клиентов АРМ (не Поставщик получатель, а Перевозчик).

